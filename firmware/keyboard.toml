# Documentation: https://rmk.rs/docs
# POWER SWITCH: LEFT IS ON, RIGHT IS OFF (BOTH SIDES)
[keyboard]
name = "TOTEM"
product_name = "TOTEM"
vendor_id = 0x4C4B
product_id = 0x544D
manufacturer = "GEIGEIGEIST"
serial_number = "vial:f64c2b3c"
chip = "nrf52840"
usb_enable = true

# TOTEM: 38-key split keyboard
# Matrix: 4 rows x 10 cols (5 cols per side)
# Physical layout:
#          | 00 | 01 | 02 | 03 | 04 |   | 05 | 06 | 07 | 08 | 09 |
#          | 10 | 11 | 12 | 13 | 14 |   | 15 | 16 | 17 | 18 | 19 |
#     | 30 | 20 | 21 | 22 | 23 | 24 |   | 25 | 26 | 27 | 28 | 29 | 39 |
#                    | 32 | 33 | 34 |   | 35 | 36 | 37 |

[layout]
rows = 4
cols = 10
layers = 7
keymap = [
    # Layer 0: Base (Gallium colstag)
    # Top:    B L D C V | J Y O U ,
    # Home:   N R T S G | P H A E I
    # Bottom: X Q M W Z | K F ' ; .
    #         ^Ctrl ^Gui ^Alt       ^Alt ^Gui ^Ctrl (hold for mod)
    # Thumbs: Esc(Fn) Space(Nav) Tab(Mouse) | Enter(Media) Backspace(Num) Delete
    [
        ["B",      "L",      "D",      "C",      "V",           "J",      "Y",      "O",      "U",      "Comma"    ],
        ["N",      "R",      "T",      "S",      "G",           "P",      "H",      "A",      "E",      "I"        ],
        ["MT(X,LCtrl)", "MT(Q,LGui)", "MT(M,LAlt)", "W", "Z",   "K", "F", "MT(Quote,RAlt)", "MT(Semicolon,RGui)", "MT(Dot,RCtrl)"],
        ["LShift", "_",      "LT(1,Escape)", "LT(2,Space)", "LT(3,Tab)", "LT(4,Enter)", "LT(5,Backspace)", "Delete", "_", "RShift"]
    ],
    # Layer 1: Function + BLE (hold Escape)
    # F1-F10 on top row, F keys on right numpad positions
    # BLE controls on left bottom row
    # TG(6) on N position to toggle gaming layer
    [
        ["F1",     "F2",     "F3",     "F4",     "F5",          "F6",     "F7",     "F8",     "F9",     "F10"      ],
        ["TG(6)",  "F11",    "F12",    "_",      "_",           "_",      "F4",     "F5",     "F6",     "_"        ],
        ["User6",  "User0",  "User1",  "User2",  "User5",       "_",      "F1",     "F2",     "F3",     "_"        ],
        ["_",      "_",      "_",      "_",      "_",           "_",      "_",      "_",      "_",      "_"        ]
    ],
    # Layer 2: Nav/Edit (hold Space)
    # Left:  editing (Cut/Copy/Paste/Undo/Redo)
    # Right: vim-like arrows (h=left, j=down, k=up, l=right) + PgUp/PgDn/Home/End
    [
        ["_",      "Cut",    "Copy",   "Paste",  "Again",       "Home",  "PageDown", "PageUp", "End",    "_"        ],
        ["Undo",   "_",      "_",      "_",      "_",           "Left",  "Down",  "Up",    "Right",  "_"        ],
        ["_",      "_",      "_",      "_",      "_",           "_",     "_",     "_",     "_",      "_"        ],
        ["_",      "_",      "_",      "_",      "_",           "_",     "_",     "_",     "_",      "_"        ]
    ],
    # Layer 3: Mouse (hold Tab)
    # Right: vim-like mouse (h=left, j=down, k=up, l=right)
    # Left:  scroll wheel + accel
    # Thumbs: Mouse buttons
    [
        ["MouseAccel0", "MouseAccel1", "MouseAccel2", "_", "_", "MouseWheelUp", "MouseWheelDown", "MouseWheelLeft", "MouseWheelRight", "_"],
        ["_",      "_",      "_",      "_",      "_",           "MouseLeft", "MouseDown", "MouseUp", "MouseRight", "_"],
        ["_",      "_",      "_",      "_",      "_",           "_",      "_",      "_",      "_",      "_"        ],
        ["_",      "_",      "_",      "_",      "_",           "MouseBtn1", "MouseBtn2", "MouseBtn3", "_", "_"    ]
    ],
    # Layer 4: Media (hold Enter)
    # Right: volume, playback, brightness
    [
        ["_",      "_",      "_",      "_",      "_",           "AudioMute", "AudioVolDown", "AudioVolUp", "_", "_"],
        ["_",      "_",      "_",      "_",      "_",           "MediaPrevTrack", "MediaPlayPause", "MediaNextTrack", "MediaStop", "_"],
        ["_",      "_",      "_",      "_",      "_",           "BrightnessDown", "BrightnessUp", "_", "_", "_"],
        ["_",      "_",      "_",      "_",      "_",           "_",      "_",      "_",      "_",      "_"        ]
    ],
    # Layer 5: Num/Sym (hold Backspace)
    # 1 2 3 4 5 | 6 7 8 9 0
    # ; ' [ ] - | - 4 5 6 /
    # / ` , . = | = 1 2 3 \
    [
        ["Kc1",    "Kc2",    "Kc3",    "Kc4",    "Kc5",         "Kc6",    "Kc7",    "Kc8",    "Kc9",    "Kc0"      ],
        ["Semicolon", "Quote", "LeftBracket", "RightBracket", "Minus", "Minus", "Kc4",  "Kc5",    "Kc6",    "Slash"    ],
        ["Slash",  "Grave",  "Comma",  "Dot",    "Equal",       "Equal",  "Kc1",    "Kc2",    "Kc3",    "Backslash"],
        ["_",      "_",      "_",      "_",      "_",           "_",      "_",      "_",      "_",      "_"        ]
    ],
    # Layer 6: Gaming (toggle from Function layer via TG(6))
    # TG(6) on N position to toggle off
    # WASD on left for movement, numbers on top for weapon switching
    [
        ["Tab",    "Q",      "W",      "E",      "R",           "Kc1",    "Kc2",    "Kc3",    "Kc4",    "Kc5"      ],
        ["TG(6)",  "A",      "S",      "D",      "F",           "G",      "H",      "J",      "K",      "L"        ],
        ["LCtrl",  "Z",      "X",      "C",      "V",           "B",      "N",      "M",      "Comma",  "Dot"      ],
        ["_",      "_",      "_",      "_",      "_",           "_",      "_",      "_",      "_",      "_"        ]
    ]
]

[storage]
enabled = true
# Clear stored keymap on next boot to apply TOML config
clear_storage = true

# Chip-specific config for nRF52840
# WARNING: Only enable DC/DC regulators if your board has external LC filters
# XIAO nRF52840 has these, so it's safe to enable for better power efficiency
[chip.nrf52840]
dcdc_reg0 = true
dcdc_reg1 = true

[ble]
enabled = true

[split]
connection = "ble"

# Central = Left half
[split.central]
rows = 4
cols = 5
row_offset = 0
col_offset = 0

[split.central.matrix]
row_pins = ["P0_02", "P0_03", "P0_28", "P0_29"]
col_pins = ["P0_04", "P0_05", "P1_15", "P1_14", "P1_13"]

# Peripheral = Right half
[[split.peripheral]]
rows = 4
cols = 5
row_offset = 0
col_offset = 5

[split.peripheral.matrix]
row_pins = ["P0_02", "P0_03", "P0_28", "P0_29"]
col_pins = ["P1_13", "P1_14", "P1_15", "P0_05", "P0_04"]
